2025-08-20 22:48:08 [INFO] Starting migration process...
2025-08-20 22:48:08 [INFO] You will be prompted to select a networking tool and rerouting option to establish a secure connection and manage traffic between the clusters.
2025-08-20 22:48:10 [INFO] Initializing kubernetes clients
2025-08-20 22:48:11 [INFO] Checking connectivity between clusters
2025-08-20 22:48:11 [DEBUG] Fetching cluster IPs
2025-08-20 22:48:11 [DEBUG] Cleaning up probe resources
2025-08-20 22:48:11 [DEBUG] Testing connectivity with Origin IP: 192.168.100.1, Target IP: 192.168.131.3
2025-08-20 22:48:11 [DEBUG] Deploying probe resources
2025-08-20 22:48:12 [DEBUG] Waiting for pods to be ready
2025-08-20 22:48:16 [DEBUG] Pods are ready
2025-08-20 22:48:16 [DEBUG] Checking connectivity between clusters
2025-08-20 22:48:26 [DEBUG] Connectivity check successful with Origin IP: 192.168.100.1, Target IP: 192.168.131.3 - both clusters can reach each other
2025-08-20 22:48:26 [DEBUG] Cleaning up probe resources
2025-08-20 22:48:27 [DEBUG] Connectivity probe complete
2025-08-20 22:48:27 [INFO] Establishing secure connection between clusters
2025-08-20 22:48:27 [DEBUG] Create Linkerd certificates
2025-08-20 22:48:27 [INFO] Installing Linkerd
2025-08-20 22:48:27 [DEBUG] Install linkerd-crds
2025-08-20 22:48:40 [DEBUG] Install Linkerd control plane
2025-08-20 22:49:12 [DEBUG] Install linkerd-multicluster
2025-08-20 22:49:46 [INFO] Installing Linkerd
2025-08-20 22:49:46 [DEBUG] Install linkerd-crds
2025-08-20 22:49:59 [DEBUG] Install Linkerd control plane
2025-08-20 22:50:36 [DEBUG] Install linkerd-multicluster
2025-08-20 22:51:06 [INFO] Try fetching gateway service linkerd-gateway in namespace linkerd-multicluster
2025-08-20 22:51:07 [INFO] Try fetching gateway service linkerd-gateway in namespace linkerd-multicluster
2025-08-20 22:51:09 [INFO] Migrating configuration resources
2025-08-20 22:51:12 [INFO] Including namespace for Skupper: benchmark
2025-08-20 22:51:12 [INFO] Including namespace for Skupper: clustershift
2025-08-20 22:51:12 [INFO] Including namespace for Skupper: default
2025-08-20 22:51:12 [INFO] Skipping system namespace: kube-node-lease
2025-08-20 22:51:12 [INFO] Skipping system namespace: kube-public
2025-08-20 22:51:12 [INFO] Skipping system namespace: kube-system
2025-08-20 22:51:12 [INFO] Skipping system namespace: linkerd
2025-08-20 22:51:12 [INFO] Skipping system namespace: linkerd-multicluster
2025-08-20 22:51:12 [INFO] Skipping system namespace: metallb-system
2025-08-20 22:51:12 [INFO] Including namespace for Skupper: mongodb
2025-08-20 22:51:12 [INFO] Skipping system namespace: traefik
2025-08-20 22:51:12 [INFO] Number of valid namespaces found: 4
2025-08-20 22:51:13 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:51:13 [INFO] Waiting for deployments to be ready in namespace benchmark
2025-08-20 22:51:13 [INFO] Waiting for statefulsets to be ready in namespace benchmark
2025-08-20 22:51:13 [INFO] Restarting deployment metrics-collector in namespace clustershift
2025-08-20 22:51:13 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:51:13 [INFO] Waiting for deployments to be ready in namespace clustershift
2025-08-20 22:51:18 [INFO] Deployment metrics-collector is ready
2025-08-20 22:51:18 [INFO] Waiting for statefulsets to be ready in namespace clustershift
2025-08-20 22:51:18 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:51:18 [INFO] Waiting for deployments to be ready in namespace default
2025-08-20 22:51:18 [INFO] Waiting for statefulsets to be ready in namespace default
2025-08-20 22:51:19 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:51:19 [INFO] Waiting for deployments to be ready in namespace mongodb
2025-08-20 22:51:19 [INFO] Waiting for statefulsets to be ready in namespace mongodb
2025-08-20 22:51:19 [INFO] Scanning for existing cnpg databases
2025-08-20 22:51:19 [INFO] No existing cnpg databases found, skipping migration
2025-08-20 22:51:19 [INFO] Migrating MongoDBs
2025-08-20 22:51:19 [INFO] No existing MongoDBs found, skipping migration
2025-08-20 22:51:19 [INFO] Checking for existing MongoDB Community Operator deployment
2025-08-20 22:51:19 [DEBUG] Found MongoDB Community Operator version 0.13.0 in namespace mongodb
2025-08-20 22:51:19 [INFO] Deploying MongoDB Community Operator version 0.13.0 to target cluster
2025-08-20 22:51:28 [DEBUG] Found 1 MongoDB databases in origin cluster
2025-08-20 22:51:28 [DEBUG] Creating MongoDB client pod...
2025-08-20 22:51:28 [DEBUG] Waiting for MongoDB client pod to be ready...
2025-08-20 22:51:46 [DEBUG] Creating MongoDB client pod...
2025-08-20 22:51:46 [DEBUG] Waiting for MongoDB client pod to be ready...
2025-08-20 22:52:04 [DEBUG] Deploying MongoDB cluster example-mongodb in namespace mongodb
2025-08-20 22:52:04 [DEBUG] Waiting for MongoDB cluster example-mongodb in namespace mongodb to be ready
2025-08-20 22:52:09 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: 
2025-08-20 22:52:14 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:19 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:24 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:29 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:34 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:39 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:44 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:49 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:52:55 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:53:00 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:53:00 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is ready
2025-08-20 22:53:05 [INFO] Exporting service example-mongodb-svc in namespace mongodb
2025-08-20 22:53:05 [INFO] Adding linkerd.io/inject=enabled annotation to namespace mongodb
2025-08-20 22:53:05 [INFO] Injecting namespace default with linkerd
2025-08-20 22:53:05 [INFO] Rerolling all pods in namespace default
2025-08-20 22:53:05 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:53:05 [INFO] Waiting for deployments to be ready in namespace default
2025-08-20 22:53:05 [INFO] Waiting for statefulsets to be ready in namespace default
2025-08-20 22:53:13 [DEBUG] MongoDB command output: {"set":"example-mongodb","date":"2025-08-20T20:53:13.052Z","myState":2,"term":{"low":1,"high":0,"unsigned":false},"syncSourceHost":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","syncSourceId":0,"heartbeatIntervalMillis":{"low":2000,"high":0,"unsigned":false},"majorityVoteCount":2,"writeMajorityCount":2,"votingMembersCount":2,"writableVotingMembersCount":2,"optimes":{"lastCommittedOpTime":{"ts":{"$timestamp":"7540773690468728839"},"t":{"low":1,"high":0,"unsigned":false}},"lastCommittedWallTime":"2025-08-20T20:53:12.939Z","readConcernMajorityOpTime":{"ts":{"$timestamp":"7540773690468728839"},"t":{"low":1,"high":0,"unsigned":false}},"appliedOpTime":{"ts":{"$timestamp":"7540773690468728839"},"t":{"low":1,"high":0,"unsigned":false}},"durableOpTime":{"ts":{"$timestamp":"7540773690468728839"},"t":{"low":1,"high":0,"unsigned":false}},"lastAppliedWallTime":"2025-08-20T20:53:12.939Z","lastDurableWallTime":"2025-08-20T20:53:12.939Z"},"lastStableRecoveryTimestamp":{"$timestamp":"7540773578799579145"},"electionParticipantMetrics":{"votedForCandidate":true,"electionTerm":{"low":1,"high":0,"unsigned":false},"lastVoteDate":"2025-08-20T20:43:45.205Z","electionCandidateMemberId":0,"voteReason":"","lastAppliedOpTimeAtElection":{"ts":{"$timestamp":"7540771203682664449"},"t":{"low":-1,"high":-1,"unsigned":false}},"maxAppliedOpTimeInSet":{"ts":{"$timestamp":"7540771203682664449"},"t":{"low":-1,"high":-1,"unsigned":false}},"priorityAtElection":1,"newTermStartDate":"2025-08-20T20:43:45.263Z","newTermAppliedDate":"2025-08-20T20:43:46.460Z"},"members":[{"_id":0,"name":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","health":1,"state":1,"stateStr":"PRIMARY","uptime":578,"optime":{"ts":{"$timestamp":"7540773686173761537"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDurable":{"ts":{"$timestamp":"7540773686173761537"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDate":"2025-08-20T20:53:11.000Z","optimeDurableDate":"2025-08-20T20:53:11.000Z","lastAppliedWallTime":"2025-08-20T20:53:11.032Z","lastDurableWallTime":"2025-08-20T20:53:11.032Z","lastHeartbeat":"2025-08-20T20:53:11.114Z","lastHeartbeatRecv":"2025-08-20T20:53:11.565Z","pingMs":{"low":0,"high":0,"unsigned":false},"lastHeartbeatMessage":"","syncSourceHost":"","syncSourceId":-1,"infoMessage":"","electionTime":{"$timestamp":"7540771255222272001"},"electionDate":"2025-08-20T20:43:45.000Z","configVersion":1,"configTerm":1},{"_id":1,"name":"example-mongodb-1.example-mongodb-svc.mongodb.svc.cluster.local:27017","health":1,"state":2,"stateStr":"SECONDARY","uptime":582,"optime":{"ts":{"$timestamp":"7540773690468728839"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDate":"2025-08-20T20:53:12.000Z","lastAppliedWallTime":"2025-08-20T20:53:12.939Z","lastDurableWallTime":"2025-08-20T20:53:12.939Z","syncSourceHost":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","syncSourceId":0,"infoMessage":"","configVersion":1,"configTerm":1,"self":true,"lastHeartbeatMessage":""}],"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":"7540773690468728839"},"signature":{"hash":"G8Le+JtTw52FxR3RgG/5m2yBe9o=","keyId":{"low":5,"high":1755722625,"unsigned":false}}},"operationTime":{"$timestamp":"7540773690468728839"}}

2025-08-20 22:53:15 [DEBUG] MongoDB command output: {"set":"example-mongodb","date":"2025-08-20T20:53:15.816Z","myState":1,"term":{"low":1,"high":0,"unsigned":false},"syncSourceHost":"","syncSourceId":-1,"heartbeatIntervalMillis":{"low":2000,"high":0,"unsigned":false},"majorityVoteCount":1,"writeMajorityCount":1,"votingMembersCount":1,"writableVotingMembersCount":1,"optimes":{"lastCommittedOpTime":{"ts":{"$timestamp":"7540773664698925057"},"t":{"low":1,"high":0,"unsigned":false}},"lastCommittedWallTime":"2025-08-20T20:53:06.712Z","readConcernMajorityOpTime":{"ts":{"$timestamp":"7540773664698925057"},"t":{"low":1,"high":0,"unsigned":false}},"appliedOpTime":{"ts":{"$timestamp":"7540773664698925057"},"t":{"low":1,"high":0,"unsigned":false}},"durableOpTime":{"ts":{"$timestamp":"7540773664698925057"},"t":{"low":1,"high":0,"unsigned":false}},"lastAppliedWallTime":"2025-08-20T20:53:06.712Z","lastDurableWallTime":"2025-08-20T20:53:06.712Z"},"lastStableRecoveryTimestamp":{"$timestamp":"7540773578799579137"},"electionCandidateMetrics":{"lastElectionReason":"electionTimeout","lastElectionDate":"2025-08-20T20:52:46.646Z","electionTerm":{"low":1,"high":0,"unsigned":false},"lastCommittedOpTimeAtElection":{"ts":{"$timestamp":"7540773578799579137"},"t":{"low":-1,"high":-1,"unsigned":false}},"lastSeenOpTimeAtElection":{"ts":{"$timestamp":"7540773578799579137"},"t":{"low":-1,"high":-1,"unsigned":false}},"numVotesNeeded":1,"priorityAtElection":1,"electionTimeoutMillis":{"low":10000,"high":0,"unsigned":false},"newTermStartDate":"2025-08-20T20:52:46.691Z","wMajorityWriteAvailabilityDate":"2025-08-20T20:52:46.714Z"},"members":[{"_id":0,"name":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","health":1,"state":1,"stateStr":"PRIMARY","uptime":30,"optime":{"ts":{"$timestamp":"7540773664698925057"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDate":"2025-08-20T20:53:06.000Z","lastAppliedWallTime":"2025-08-20T20:53:06.712Z","lastDurableWallTime":"2025-08-20T20:53:06.712Z","syncSourceHost":"","syncSourceId":-1,"infoMessage":"Could not find member to sync from","electionTime":{"$timestamp":"7540773578799579138"},"electionDate":"2025-08-20T20:52:46.000Z","configVersion":1,"configTerm":1,"self":true,"lastHeartbeatMessage":""}],"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":"7540773664698925057"},"signature":{"hash":"XkD6DeT0Qbf/q4JDcKYQmHokwYw=","keyId":{"low":6,"high":1755723166,"unsigned":false}}},"operationTime":{"$timestamp":"7540773664698925057"}}

2025-08-20 22:53:15 [INFO] Primary MongoDB host in origin cluster: example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local
2025-08-20 22:53:15 [INFO] Primary MongoDB host in target cluster: example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local
2025-08-20 22:53:18 [DEBUG] MongoDB command output: {
  ok: 1,
  '$clusterTime': {
    clusterTime: Timestamp({ t: 1755723198, i: 2 }),
    signature: {
      hash: Binary.createFromBase64('l7g0/o33cLlcvCw/9BjhWz8nwqo=', 0),
      keyId: Long('7540771255222272005')
    }
  },
  operationTime: Timestamp({ t: 1755723198, i: 2 })
}

2025-08-20 22:53:20 [DEBUG] MongoDB command output: {
  ok: 1,
  '$clusterTime': {
    clusterTime: Timestamp({ t: 1755723200, i: 1 }),
    signature: {
      hash: Binary.createFromBase64('MZu9Ox3QGlAj88BeVJyoBGctfcs=', 0),
      keyId: Long('7540773578799579142')
    }
  },
  operationTime: Timestamp({ t: 1755723200, i: 1 })
}

2025-08-20 22:53:23 [DEBUG] MongoDB command output: {"_id":"example-mongodb","version":1,"term":1,"members":[{"_id":0,"host":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","arbiterOnly":false,"buildIndexes":true,"hidden":false,"priority":1,"tags":{},"secondaryDelaySecs":{"low":0,"high":0,"unsigned":false},"votes":1},{"_id":1,"host":"example-mongodb-1.example-mongodb-svc.mongodb.svc.cluster.local:27017","arbiterOnly":false,"buildIndexes":true,"hidden":false,"priority":1,"tags":{},"secondaryDelaySecs":{"low":0,"high":0,"unsigned":false},"votes":1}],"protocolVersion":{"low":1,"high":0,"unsigned":false},"writeConcernMajorityJournalDefault":true,"settings":{"chainingAllowed":true,"heartbeatIntervalMillis":2000,"heartbeatTimeoutSecs":10,"electionTimeoutMillis":10000,"catchUpTimeoutMillis":-1,"catchUpTakeoverDelayMillis":30000,"getLastErrorModes":{},"getLastErrorDefaults":{"w":1,"wtimeout":0},"replicaSetId":"68a63375e45b31b365be71c6"}}

2025-08-20 22:53:23 [INFO] mongodb://clusteradmin:password1@example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017,example-mongodb-1.example-mongodb-svc.mongodb.svc.cluster.local:27017/?authSource=admin
2025-08-20 22:53:25 [DEBUG] MongoDB command output: {"_id":"example-mongodb","version":1,"term":1,"members":[{"_id":0,"host":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","arbiterOnly":false,"buildIndexes":true,"hidden":false,"priority":1,"tags":{},"secondaryDelaySecs":{"low":0,"high":0,"unsigned":false},"votes":1}],"protocolVersion":{"low":1,"high":0,"unsigned":false},"writeConcernMajorityJournalDefault":true,"settings":{"chainingAllowed":true,"heartbeatIntervalMillis":2000,"heartbeatTimeoutSecs":10,"electionTimeoutMillis":10000,"catchUpTimeoutMillis":-1,"catchUpTakeoverDelayMillis":30000,"getLastErrorModes":{},"getLastErrorDefaults":{"w":1,"wtimeout":0},"replicaSetId":"68a6359ecdbd39d23aef3eec"}}

2025-08-20 22:53:25 [INFO] mongodb://clusteradmin:password1@example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017/?authSource=admin
2025-08-20 22:53:31 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:53:36 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:53:41 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:53:46 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:53:51 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:53:56 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:54:01 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:54:06 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:54:11 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:54:16 [DEBUG] Job mongosyncer-job in namespace default has completed
2025-08-20 22:54:18 [DEBUG] MongoDB command output: {
  ok: 1,
  '$clusterTime': {
    clusterTime: Timestamp({ t: 1755723258, i: 1 }),
    signature: {
      hash: Binary.createFromBase64('F2VPwJbSQLMvsKcvyeS39X+axz0=', 0),
      keyId: Long('7540773578799579142')
    }
  },
  operationTime: Timestamp({ t: 1755723258, i: 1 })
}

2025-08-20 22:54:18 [DEBUG] Deleting MongoDB client pod...
2025-08-20 22:54:18 [DEBUG] Deleting MongoDB client pod...
2025-08-20 22:54:18 [DEBUG] Restoring MongoDB cluster example-mongodb member count to 2
2025-08-20 22:54:18 [INFO] Migrating PostgreSQL databases
2025-08-20 22:54:18 [INFO] No existing PostgreSQL databases found, skipping migration
2025-08-20 22:54:18 [INFO] Migrating resources
2025-08-20 22:54:20 [INFO] Enable request forwarding from origin
2025-08-20 22:54:20 [INFO] Mirroring service clustershift-benchmark-service in namespace benchmark
2025-08-20 22:54:20 [INFO] Mirroring service metrics-collector in namespace clustershift
2025-08-20 22:54:20 [INFO] Mirroring service kubernetes in namespace default
2025-08-20 22:54:20 [INFO] Mirroring service kube-dns in namespace kube-system
2025-08-20 22:54:20 [INFO] Mirroring service metrics-server in namespace kube-system
2025-08-20 22:54:20 [INFO] Mirroring service linkerd-gateway in namespace linkerd-multicluster
2025-08-20 22:54:20 [INFO] Mirroring service probe-gateway-origin in namespace linkerd-multicluster
2025-08-20 22:54:20 [INFO] Mirroring service probe-gateway-target in namespace linkerd-multicluster
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-dst in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-dst-headless in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-identity in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-identity-headless in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-policy in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-policy-validator in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-proxy-injector in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service linkerd-sp-validator in namespace linkerd
2025-08-20 22:54:21 [INFO] Mirroring service metallb-webhook-service in namespace metallb-system
2025-08-20 22:54:22 [INFO] Mirroring service example-mongodb-svc in namespace mongodb
2025-08-20 22:54:22 [INFO] Mirroring service traefik in namespace traefik
2025-08-20 22:54:22 [INFO] Restarting deployment traefik in namespace traefik
2025-08-20 22:54:23 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:54:23 [INFO] Waiting for deployments to be ready in namespace traefik
2025-08-20 22:54:28 [INFO] Deployment traefik is ready
2025-08-20 22:54:28 [INFO] Waiting for statefulsets to be ready in namespace traefik
2025-08-20 22:54:28 [INFO] Updating service name in IngressRoute clustershift-benchmark-ingress-route from clustershift-benchmark-service to clustershift-benchmark-service-target
2025-08-20 22:54:28 [INFO] Updating service name in IngressRoute metrics-collector-route from metrics-collector to metrics-collector-target
2025-08-20 22:54:28 [DEBUG] Ignoring IngressRoute traefik-dashboard as it is the Traefik dashboard
2025-08-20 22:54:28 [INFO] Migration complete

2025-08-20 22:12:15 [INFO] Starting migration process...
2025-08-20 22:12:15 [INFO] You will be prompted to select a networking tool and rerouting option to establish a secure connection and manage traffic between the clusters.
2025-08-20 22:12:20 [INFO] Initializing kubernetes clients
2025-08-20 22:12:20 [INFO] Checking connectivity between clusters
2025-08-20 22:12:20 [DEBUG] Fetching cluster IPs
2025-08-20 22:12:21 [DEBUG] Cleaning up probe resources
2025-08-20 22:12:21 [DEBUG] Testing connectivity with Origin IP: 192.168.100.1, Target IP: 192.168.131.3
2025-08-20 22:12:21 [DEBUG] Deploying probe resources
2025-08-20 22:12:22 [DEBUG] Waiting for pods to be ready
2025-08-20 22:12:28 [DEBUG] Pods are ready
2025-08-20 22:12:29 [DEBUG] Checking connectivity between clusters
2025-08-20 22:12:39 [DEBUG] Connectivity check successful with Origin IP: 192.168.100.1, Target IP: 192.168.131.3 - both clusters can reach each other
2025-08-20 22:12:39 [DEBUG] Cleaning up probe resources
2025-08-20 22:12:39 [DEBUG] Connectivity probe complete
2025-08-20 22:12:39 [INFO] Establishing secure connection between clusters
2025-08-20 22:12:39 [DEBUG] Create Linkerd certificates
2025-08-20 22:12:39 [INFO] Installing Linkerd
2025-08-20 22:12:39 [DEBUG] Install linkerd-crds
2025-08-20 22:12:52 [DEBUG] Install Linkerd control plane
2025-08-20 22:13:27 [DEBUG] Install linkerd-multicluster
2025-08-20 22:14:05 [INFO] Installing Linkerd
2025-08-20 22:14:05 [DEBUG] Install linkerd-crds
2025-08-20 22:14:19 [DEBUG] Install Linkerd control plane
2025-08-20 22:14:56 [DEBUG] Install linkerd-multicluster
2025-08-20 22:15:27 [INFO] Try fetching gateway service linkerd-gateway in namespace linkerd-multicluster
2025-08-20 22:15:29 [INFO] Try fetching gateway service linkerd-gateway in namespace linkerd-multicluster
2025-08-20 22:15:30 [INFO] Migrating configuration resources
2025-08-20 22:15:34 [INFO] Including namespace for Skupper: benchmark
2025-08-20 22:15:34 [INFO] Including namespace for Skupper: clustershift
2025-08-20 22:15:34 [INFO] Including namespace for Skupper: default
2025-08-20 22:15:34 [INFO] Skipping system namespace: kube-node-lease
2025-08-20 22:15:34 [INFO] Skipping system namespace: kube-public
2025-08-20 22:15:34 [INFO] Skipping system namespace: kube-system
2025-08-20 22:15:34 [INFO] Skipping system namespace: linkerd
2025-08-20 22:15:34 [INFO] Skipping system namespace: linkerd-multicluster
2025-08-20 22:15:34 [INFO] Skipping system namespace: metallb-system
2025-08-20 22:15:34 [INFO] Including namespace for Skupper: mongodb
2025-08-20 22:15:34 [INFO] Skipping system namespace: traefik
2025-08-20 22:15:34 [INFO] Number of valid namespaces found: 4
2025-08-20 22:15:34 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:15:34 [INFO] Waiting for deployments to be ready in namespace benchmark
2025-08-20 22:15:34 [INFO] Waiting for statefulsets to be ready in namespace benchmark
2025-08-20 22:15:34 [INFO] Restarting deployment metrics-collector in namespace clustershift
2025-08-20 22:15:34 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:15:34 [INFO] Waiting for deployments to be ready in namespace clustershift
2025-08-20 22:15:39 [INFO] Deployment metrics-collector is ready
2025-08-20 22:15:39 [INFO] Waiting for statefulsets to be ready in namespace clustershift
2025-08-20 22:15:40 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:15:40 [INFO] Waiting for deployments to be ready in namespace default
2025-08-20 22:15:40 [INFO] Waiting for statefulsets to be ready in namespace default
2025-08-20 22:15:40 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:15:40 [INFO] Waiting for deployments to be ready in namespace mongodb
2025-08-20 22:15:40 [INFO] Waiting for statefulsets to be ready in namespace mongodb
2025-08-20 22:15:40 [INFO] Scanning for existing cnpg databases
2025-08-20 22:15:40 [INFO] No existing cnpg databases found, skipping migration
2025-08-20 22:15:40 [INFO] Migrating MongoDBs
2025-08-20 22:15:40 [INFO] No existing MongoDBs found, skipping migration
2025-08-20 22:15:40 [INFO] Checking for existing MongoDB Community Operator deployment
2025-08-20 22:15:40 [DEBUG] Found MongoDB Community Operator version 0.13.0 in namespace mongodb
2025-08-20 22:15:40 [INFO] Deploying MongoDB Community Operator version 0.13.0 to target cluster
2025-08-20 22:15:51 [DEBUG] Found 1 MongoDB databases in origin cluster
2025-08-20 22:15:51 [DEBUG] Creating MongoDB client pod...
2025-08-20 22:15:51 [DEBUG] Waiting for MongoDB client pod to be ready...
2025-08-20 22:16:06 [DEBUG] Creating MongoDB client pod...
2025-08-20 22:16:06 [DEBUG] Waiting for MongoDB client pod to be ready...
2025-08-20 22:16:24 [DEBUG] Deploying MongoDB cluster example-mongodb in namespace mongodb
2025-08-20 22:16:24 [DEBUG] Waiting for MongoDB cluster example-mongodb in namespace mongodb to be ready
2025-08-20 22:16:29 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: 
2025-08-20 22:16:34 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:16:39 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:16:44 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:16:50 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:16:55 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:17:00 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:17:05 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:17:10 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:17:15 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:17:20 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is not ready yet, current phase: Pending
2025-08-20 22:17:20 [DEBUG] MongoDB cluster example-mongodb in namespace mongodb is ready
2025-08-20 22:17:25 [INFO] Exporting service example-mongodb-svc in namespace mongodb
2025-08-20 22:17:25 [INFO] Adding linkerd.io/inject=enabled annotation to namespace mongodb
2025-08-20 22:17:25 [INFO] Injecting namespace default with linkerd
2025-08-20 22:17:25 [INFO] Rerolling all pods in namespace default
2025-08-20 22:17:26 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:17:26 [INFO] Waiting for deployments to be ready in namespace default
2025-08-20 22:17:26 [INFO] Waiting for statefulsets to be ready in namespace default
2025-08-20 22:17:33 [DEBUG] MongoDB command output: {"set":"example-mongodb","date":"2025-08-20T20:17:33.538Z","myState":1,"term":{"low":1,"high":0,"unsigned":false},"syncSourceHost":"","syncSourceId":-1,"heartbeatIntervalMillis":{"low":2000,"high":0,"unsigned":false},"majorityVoteCount":2,"writeMajorityCount":2,"votingMembersCount":2,"writableVotingMembersCount":2,"optimes":{"lastCommittedOpTime":{"ts":{"$timestamp":"7540764503533682692"},"t":{"low":1,"high":0,"unsigned":false}},"lastCommittedWallTime":"2025-08-20T20:17:33.502Z","readConcernMajorityOpTime":{"ts":{"$timestamp":"7540764503533682692"},"t":{"low":1,"high":0,"unsigned":false}},"appliedOpTime":{"ts":{"$timestamp":"7540764503533682692"},"t":{"low":1,"high":0,"unsigned":false}},"durableOpTime":{"ts":{"$timestamp":"7540764503533682692"},"t":{"low":1,"high":0,"unsigned":false}},"lastAppliedWallTime":"2025-08-20T20:17:33.502Z","lastDurableWallTime":"2025-08-20T20:17:33.502Z"},"lastStableRecoveryTimestamp":{"$timestamp":"7540764370389696514"},"electionCandidateMetrics":{"lastElectionReason":"electionTimeout","lastElectionDate":"2025-08-20T20:08:12.252Z","electionTerm":{"low":1,"high":0,"unsigned":false},"lastCommittedOpTimeAtElection":{"ts":{"$timestamp":"7540762046812389377"},"t":{"low":-1,"high":-1,"unsigned":false}},"lastSeenOpTimeAtElection":{"ts":{"$timestamp":"7540762046812389377"},"t":{"low":-1,"high":-1,"unsigned":false}},"numVotesNeeded":2,"priorityAtElection":1,"electionTimeoutMillis":{"low":10000,"high":0,"unsigned":false},"numCatchUpOps":{"low":0,"high":0,"unsigned":false},"newTermStartDate":"2025-08-20T20:08:12.319Z","wMajorityWriteAvailabilityDate":"2025-08-20T20:08:13.395Z"},"members":[{"_id":0,"name":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","health":1,"state":1,"stateStr":"PRIMARY","uptime":626,"optime":{"ts":{"$timestamp":"7540764503533682692"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDate":"2025-08-20T20:17:33.000Z","lastAppliedWallTime":"2025-08-20T20:17:33.502Z","lastDurableWallTime":"2025-08-20T20:17:33.502Z","syncSourceHost":"","syncSourceId":-1,"infoMessage":"","electionTime":{"$timestamp":"7540762094057029633"},"electionDate":"2025-08-20T20:08:12.000Z","configVersion":1,"configTerm":1,"self":true,"lastHeartbeatMessage":""},{"_id":1,"name":"example-mongodb-1.example-mongodb-svc.mongodb.svc.cluster.local:27017","health":1,"state":2,"stateStr":"SECONDARY","uptime":571,"optime":{"ts":{"$timestamp":"7540764499238715394"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDurable":{"ts":{"$timestamp":"7540764499238715394"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDate":"2025-08-20T20:17:32.000Z","optimeDurableDate":"2025-08-20T20:17:32.000Z","lastAppliedWallTime":"2025-08-20T20:17:33.502Z","lastDurableWallTime":"2025-08-20T20:17:33.502Z","lastHeartbeat":"2025-08-20T20:17:32.608Z","lastHeartbeatRecv":"2025-08-20T20:17:32.139Z","pingMs":{"low":0,"high":0,"unsigned":false},"lastHeartbeatMessage":"","syncSourceHost":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","syncSourceId":0,"infoMessage":"","configVersion":1,"configTerm":1}],"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":"7540764503533682692"},"signature":{"hash":"/XQGy3HjoJVpV1y5mnRZOII6w/4=","keyId":{"low":5,"high":1755720492,"unsigned":false}}},"operationTime":{"$timestamp":"7540764503533682692"}}

2025-08-20 22:17:36 [DEBUG] MongoDB command output: {"set":"example-mongodb","date":"2025-08-20T20:17:36.283Z","myState":1,"term":{"low":1,"high":0,"unsigned":false},"syncSourceHost":"","syncSourceId":-1,"heartbeatIntervalMillis":{"low":2000,"high":0,"unsigned":false},"majorityVoteCount":1,"writeMajorityCount":1,"votingMembersCount":1,"writableVotingMembersCount":1,"optimes":{"lastCommittedOpTime":{"ts":{"$timestamp":"7540764490648780801"},"t":{"low":1,"high":0,"unsigned":false}},"lastCommittedWallTime":"2025-08-20T20:17:30.166Z","readConcernMajorityOpTime":{"ts":{"$timestamp":"7540764490648780801"},"t":{"low":1,"high":0,"unsigned":false}},"appliedOpTime":{"ts":{"$timestamp":"7540764490648780801"},"t":{"low":1,"high":0,"unsigned":false}},"durableOpTime":{"ts":{"$timestamp":"7540764490648780801"},"t":{"low":1,"high":0,"unsigned":false}},"lastAppliedWallTime":"2025-08-20T20:17:30.166Z","lastDurableWallTime":"2025-08-20T20:17:30.166Z"},"lastStableRecoveryTimestamp":{"$timestamp":"7540764404749434881"},"electionCandidateMetrics":{"lastElectionReason":"electionTimeout","lastElectionDate":"2025-08-20T20:17:10.090Z","electionTerm":{"low":1,"high":0,"unsigned":false},"lastCommittedOpTimeAtElection":{"ts":{"$timestamp":"7540764404749434881"},"t":{"low":-1,"high":-1,"unsigned":false}},"lastSeenOpTimeAtElection":{"ts":{"$timestamp":"7540764404749434881"},"t":{"low":-1,"high":-1,"unsigned":false}},"numVotesNeeded":1,"priorityAtElection":1,"electionTimeoutMillis":{"low":10000,"high":0,"unsigned":false},"newTermStartDate":"2025-08-20T20:17:10.142Z","wMajorityWriteAvailabilityDate":"2025-08-20T20:17:10.167Z"},"members":[{"_id":0,"name":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","health":1,"state":1,"stateStr":"PRIMARY","uptime":27,"optime":{"ts":{"$timestamp":"7540764490648780801"},"t":{"low":1,"high":0,"unsigned":false}},"optimeDate":"2025-08-20T20:17:30.000Z","lastAppliedWallTime":"2025-08-20T20:17:30.166Z","lastDurableWallTime":"2025-08-20T20:17:30.166Z","syncSourceHost":"","syncSourceId":-1,"infoMessage":"Could not find member to sync from","electionTime":{"$timestamp":"7540764404749434882"},"electionDate":"2025-08-20T20:17:10.000Z","configVersion":1,"configTerm":1,"self":true,"lastHeartbeatMessage":""}],"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":"7540764490648780801"},"signature":{"hash":"LYYu+pHz/m33C9xLchlAEFfemO4=","keyId":{"low":7,"high":1755721030,"unsigned":false}}},"operationTime":{"$timestamp":"7540764490648780801"}}

2025-08-20 22:17:36 [INFO] Primary MongoDB host in origin cluster: example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local
2025-08-20 22:17:36 [INFO] Primary MongoDB host in target cluster: example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local
2025-08-20 22:17:38 [DEBUG] MongoDB command output: {
  ok: 1,
  '$clusterTime': {
    clusterTime: Timestamp({ t: 1755721058, i: 7 }),
    signature: {
      hash: Binary.createFromBase64('e7kJXxB5h4A5nayom/iiQmoXcxs=', 0),
      keyId: Long('7540762094057029637')
    }
  },
  operationTime: Timestamp({ t: 1755721058, i: 7 })
}

2025-08-20 22:17:40 [DEBUG] MongoDB command output: {
  ok: 1,
  '$clusterTime': {
    clusterTime: Timestamp({ t: 1755721060, i: 2 }),
    signature: {
      hash: Binary.createFromBase64('2JFQ4wefb0o7owXUilbKagMwzM4=', 0),
      keyId: Long('7540764404749434887')
    }
  },
  operationTime: Timestamp({ t: 1755721060, i: 2 })
}

2025-08-20 22:17:43 [DEBUG] MongoDB command output: {"_id":"example-mongodb","version":1,"term":1,"members":[{"_id":0,"host":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","arbiterOnly":false,"buildIndexes":true,"hidden":false,"priority":1,"tags":{},"secondaryDelaySecs":{"low":0,"high":0,"unsigned":false},"votes":1},{"_id":1,"host":"example-mongodb-1.example-mongodb-svc.mongodb.svc.cluster.local:27017","arbiterOnly":false,"buildIndexes":true,"hidden":false,"priority":1,"tags":{},"secondaryDelaySecs":{"low":0,"high":0,"unsigned":false},"votes":1}],"protocolVersion":{"low":1,"high":0,"unsigned":false},"writeConcernMajorityJournalDefault":true,"settings":{"chainingAllowed":true,"heartbeatIntervalMillis":2000,"heartbeatTimeoutSecs":10,"electionTimeoutMillis":10000,"catchUpTimeoutMillis":-1,"catchUpTakeoverDelayMillis":30000,"getLastErrorModes":{},"getLastErrorDefaults":{"w":1,"wtimeout":0},"replicaSetId":"68a62b211c1c8aa43e90523e"}}

2025-08-20 22:17:43 [INFO] mongodb://clusteradmin:password1@example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017,example-mongodb-1.example-mongodb-svc.mongodb.svc.cluster.local:27017/?authSource=admin
2025-08-20 22:17:45 [DEBUG] MongoDB command output: {"_id":"example-mongodb","version":1,"term":1,"members":[{"_id":0,"host":"example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017","arbiterOnly":false,"buildIndexes":true,"hidden":false,"priority":1,"tags":{},"secondaryDelaySecs":{"low":0,"high":0,"unsigned":false},"votes":1}],"protocolVersion":{"low":1,"high":0,"unsigned":false},"writeConcernMajorityJournalDefault":true,"settings":{"chainingAllowed":true,"heartbeatIntervalMillis":2000,"heartbeatTimeoutSecs":10,"electionTimeoutMillis":10000,"catchUpTimeoutMillis":-1,"catchUpTakeoverDelayMillis":30000,"getLastErrorModes":{},"getLastErrorDefaults":{"w":1,"wtimeout":0},"replicaSetId":"68a62d45569f31b86af916dd"}}

2025-08-20 22:17:45 [INFO] mongodb://clusteradmin:password1@example-mongodb-0.example-mongodb-svc.mongodb.svc.cluster.local:27017/?authSource=admin
2025-08-20 22:17:50 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:17:55 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:00 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:05 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:10 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:15 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:20 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:25 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:30 [DEBUG] Job mongosyncer-job in namespace default not completed yet, waiting...
2025-08-20 22:18:35 [DEBUG] Job mongosyncer-job in namespace default has completed
2025-08-20 22:18:38 [DEBUG] MongoDB command output: {
  ok: 1,
  '$clusterTime': {
    clusterTime: Timestamp({ t: 1755721118, i: 1 }),
    signature: {
      hash: Binary.createFromBase64('SucdR6R4KazzrPe2oL99ebdQl7w=', 0),
      keyId: Long('7540764404749434887')
    }
  },
  operationTime: Timestamp({ t: 1755721118, i: 1 })
}

2025-08-20 22:18:38 [DEBUG] Deleting MongoDB client pod...
2025-08-20 22:18:38 [DEBUG] Deleting MongoDB client pod...
2025-08-20 22:18:38 [DEBUG] Restoring MongoDB cluster example-mongodb member count to 2
2025-08-20 22:18:38 [INFO] Migrating PostgreSQL databases
2025-08-20 22:18:38 [INFO] No existing PostgreSQL databases found, skipping migration
2025-08-20 22:18:38 [INFO] Migrating resources
2025-08-20 22:18:40 [INFO] Enable request forwarding from origin
2025-08-20 22:18:40 [INFO] Mirroring service clustershift-benchmark-service in namespace benchmark
2025-08-20 22:18:40 [INFO] Mirroring service metrics-collector in namespace clustershift
2025-08-20 22:18:40 [INFO] Mirroring service kubernetes in namespace default
2025-08-20 22:18:40 [INFO] Mirroring service kube-dns in namespace kube-system
2025-08-20 22:18:40 [INFO] Mirroring service metrics-server in namespace kube-system
2025-08-20 22:18:40 [INFO] Mirroring service linkerd-gateway in namespace linkerd-multicluster
2025-08-20 22:18:40 [INFO] Mirroring service probe-gateway-origin in namespace linkerd-multicluster
2025-08-20 22:18:41 [INFO] Mirroring service probe-gateway-target in namespace linkerd-multicluster
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-dst in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-dst-headless in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-identity in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-identity-headless in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-policy in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-policy-validator in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-proxy-injector in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service linkerd-sp-validator in namespace linkerd
2025-08-20 22:18:41 [INFO] Mirroring service metallb-webhook-service in namespace metallb-system
2025-08-20 22:18:42 [INFO] Mirroring service example-mongodb-svc in namespace mongodb
2025-08-20 22:18:42 [INFO] Mirroring service traefik in namespace traefik
2025-08-20 22:18:42 [INFO] Restarting deployment traefik in namespace traefik
2025-08-20 22:18:43 [INFO] No CNPG clusters found or error fetching them: the server could not find the requested resource
2025-08-20 22:18:43 [INFO] Waiting for deployments to be ready in namespace traefik
2025-08-20 22:18:48 [INFO] Deployment traefik is ready
2025-08-20 22:18:48 [INFO] Waiting for statefulsets to be ready in namespace traefik
2025-08-20 22:18:48 [INFO] Updating service name in IngressRoute clustershift-benchmark-ingress-route from clustershift-benchmark-service to clustershift-benchmark-service-target
2025-08-20 22:18:48 [INFO] Updating service name in IngressRoute metrics-collector-route from metrics-collector to metrics-collector-target
2025-08-20 22:18:48 [DEBUG] Ignoring IngressRoute traefik-dashboard as it is the Traefik dashboard
2025-08-20 22:18:48 [INFO] Migration complete
